<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="max-age=86400">
    <title>Keno</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #ff0000;
            color: #fff;
            margin: 0;
            padding: 0;
        }
        #keno-wrapper {
            border: 10px solid #808080;
            display: inline-block;
            background-color: #ff3333;
            padding: 0;
            position: relative;
            box-sizing: border-box;
        }
        #keno-wrapper::after {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            border: 10px solid #000;
            z-index: 0;
        }
        #keno-wrapper.blink-border::after {
            animation: blink-green 0.5s infinite steps(1);
        }
        @keyframes blink-green {
            0%, 100% { border-color: #000; }
            50% { border-color: #008000; }
        }
        .grid {
            display: grid;
            grid-template-columns: repeat(10, 40px);
            gap: 0;
            margin: 0 auto;
            width: 400px;
        }
        .number {
            width: 38px;
            height: 38px;
            border: 1px solid #fff;
            line-height: 38px;
            cursor: pointer;
            background-color: #808080;
            transition: background-color 0.2s;
        }
        .selected { background-color: #f00; color: #fff; }
        #instructions { margin: 5px 0; }
        button {
            padding: 5px 10px;
            margin: 2px;
            background-color: #808080;
            color: #fff;
            border: none;
            cursor: pointer;
        }
        #bet-container { margin: 5px 0; }
        #bet-input { padding: 5px; width: 100px; }
    </style>
</head>
<body>
    <div id="keno-wrapper">
        <div id="grid" class="grid"></div>
        <p id="instructions">Select 10 numbers and place your bet.</p>
        <div id="bet-container">
            <input type="text" id="bet-input" value="10000">
            <button id="bet-button">Bet</button>
        </div>
        <button id="options-button">Show Options</button>
    </div>

    <script>
        const ELEMENTS = {
            grid: document.getElementById('grid'),
            instructions: document.getElementById('instructions'),
            betInput: document.getElementById('bet-input'),
            betButton: document.getElementById('bet-button'),
            optionsButton: document.getElementById('options-button'),
            kenoWrapper: document.getElementById('keno-wrapper')
        };

        const STATE = {
            selectedNumbers: new Set(),
            cash: 100000000
        };

        const CONSTANTS = {
            MAX_NUMBERS: 80,
            SELECT_LIMIT: 10,
            DRAW_COUNT: 20
        };

        const initGrid = () => {
            const fragment = document.createDocumentFragment();
            for (let i = 1; i <= CONSTANTS.MAX_NUMBERS; i++) {
                const num = document.createElement('div');
                num.className = 'number';
                num.textContent = i;
                num.addEventListener('click', () => toggleNumberSelection(i));
                fragment.appendChild(num);
            }
            ELEMENTS.grid.innerHTML = '';
            ELEMENTS.grid.appendChild(fragment);
        };

        const toggleNumberSelection = (num) => {
            if (STATE.selectedNumbers.has(num)) {
                STATE.selectedNumbers.delete(num);
            } else if (STATE.selectedNumbers.size < CONSTANTS.SELECT_LIMIT) {
                STATE.selectedNumbers.add(num);
            }
            updateGrid();
        };

        const updateGrid = () => {
            const numbers = Array.from(ELEMENTS.grid.children);
            numbers.forEach((num, i) => {
                const numValue = i + 1;
                num.className = 'number' + (STATE.selectedNumbers.has(numValue) ? ' selected' : '');
            });
        };

        const drawNumbers = () => {
            const allNumbers = Array.from({ length: CONSTANTS.MAX_NUMBERS }, (_, i) => i + 1);
            return Array.from({ length: CONSTANTS.DRAW_COUNT }, () => allNumbers.splice(Math.floor(Math.random() * allNumbers.length), 1)[0]);
        };

        const playGame = () => {
            if (STATE.selectedNumbers.size !== CONSTANTS.SELECT_LIMIT) {
                alert('Select exactly 10 numbers!');
                return;
            }
            const bet = parseInt(ELEMENTS.betInput.value.replace(/,/g, '')) || 0;
            if (bet <= 0 || bet > STATE.cash) {
                alert('Invalid bet amount!');
                return;
            }
            STATE.cash -= bet;
            const drawn = drawNumbers();
            const hits = drawn.filter(num => STATE.selectedNumbers.has(num)).length;
            let winnings = 0;
            if (hits >= 5) winnings = bet * (hits === 5 ? 5 : hits === 6 ? 24 : hits === 7 ? 142 : hits === 8 ? 1000 : hits === 9 ? 4500 : 10000);
            STATE.cash += winnings;
            ELEMENTS.instructions.textContent = `Hits: ${hits}, Won: $${winnings}, Cash: $${STATE.cash}`;
            if (hits >= 5) {
                ELEMENTS.kenoWrapper.classList.add('blink-border');
                setTimeout(() => ELEMENTS.kenoWrapper.classList.remove('blink-border'), hits >= 9 ? 10000 : hits >= 7 ? 5000 : 2000);
            }
        };

        const toggleOptions = () => {
            alert('Options toggled!'); // Placeholder for now
        };

        ELEMENTS.betButton.addEventListener('click', playGame);
        ELEMENTS.optionsButton.addEventListener('click', toggleOptions);

        window.addEventListener('DOMContentLoaded', initGrid);
    </script>
</body>
</html>